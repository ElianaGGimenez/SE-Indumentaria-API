<h1>{{product.nombre}}</h1>
<img src="{{product.img}}" width="200" />
<p>{{product.descripcion}}</p>
<p>Precio: ${{product.precio}}</p>
<p>Categoria: {{product.categoria}}</p>

<form onsubmit="addToCart(event, '{{product._id}}')">
  <button type="submit">Agregar al carrito</button>
</form>

<script>
  async function addToCart(e, pid){
    e.preventDefault();
    let cartId = localStorage.getItem('cartId');
    if(!cartId){
      const res = await fetch('/api/carts', { method: 'POST' });
      const data = await res.json();
      cartId = data.payload._id;
      localStorage.setItem('cartId', cartId);
    }
    await fetch(`/api/carts/${cartId}/product/${pid}`, { method: 'POST' });
    alert('Agregado');
  }
</script>
